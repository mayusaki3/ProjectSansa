# 認証・セキュリティ チェックリスト

Project Sansa のユーザー登録/認証周りで、必ず仕様化・実装・運用すべき項目。  
docs/ja-JP/目次.md から辿れるように配置。

---

## 優先度 高（実装前に仕様化）

- [ ] **鍵運用標準（KMS）**
  - JWT署名鍵・監査HMAC鍵は KMS 管理、生成・使用ログ・ローテをRunbook化
  - JWKSローテ中の新旧kid併用と緊急失効の運用手順を明文化

- [ ] **WebAuthn 実装方式**
  - VRクライアントの実装経路を確定（FIDO2ネイティブ or WebView）
  - RP ID / Origin を明記（例: `app.sansa.example`）
  - UV=required / preferred の方針を固定

- [ ] **E2Eテストに鍵ローテ中シナリオを追加**
  - 複数APIサーバ間で新旧kidが混在しても検証成功
  - グレース終了後に古鍵を拒否

- [ ] **メールリスク運用**
  - バウンス検知→メールOTP一時無効→ユーザー通知
  - レピュテーション低下時の送信レート抑制

- [ ] **回復コード**
  - 一度きり利用可能なN枚の回復コードを発行
  - 再発行時は旧コードを全無効化

---

## 優先度 中（順次対応）

- [ ] **動的レート制限**
  - Remote config / feature flag で閾値即時変更可能に
  - ASN/国別リスク加点を `riskScore` に反映

- [ ] **ユーザー通知（強制）**
  - 新端末ログイン／資格情報追加・削除／logout_all／RT再利用検知を必ず通知

- [ ] **同形異字/ホモグラフ対策**
  - accountId の正規化と混在スクリプト制限

- [ ] **運用ダッシュボード**
  - tv_mismatch_count / rt_reuse_detected / mfa_challenge_rate 等をメトリクス化
  - 閾値アラートを定義

---

## リンク

- [API仕様](../API仕様/)
- [監査設計](./監査.md)
